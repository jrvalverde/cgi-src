<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>WebGRAMM: show_results.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>show_results.php</h1><a href="show__results_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 &lt;?
00002 <span class="comment">// $Id: show_results.php,v 1.1 2003/05/13 13:41:39 root Exp netadmin $</span>
00003 <span class="comment">// $Log: show_results.php,v $</span>
00004 <span class="comment">// Revision 1.1  2003/05/13 13:41:39  root</span>
00005 <span class="comment">// Initial revision</span>
00006 <span class="comment">//</span>
00007 
00008 <span class="comment">// We need to know</span>
00009 <span class="comment">// Our server name</span>
<a name="l00010"></a><a class="code" href="show__results_8php.html#a0">00010</a> <a class="code" href="show__results_8php.html#a0">$server</a>=<span class="stringliteral">"http://www.es.embnet.org"</span>;
00011 
00012 
00013 <span class="comment">// Where are we</span>
<a name="l00014"></a><a class="code" href="show__results_8php.html#a1">00014</a> <a class="code" href="show__results_8php.html#a1">$http_root</a>=<span class="stringliteral">"/data/www/EMBnet"</span>;
00015 <span class="comment"></span>
00016 <span class="comment">///     Location of auxiliary servlets</span>
00017 <span class="comment"></span><span class="comment">//</span>
00018 <span class="comment">//      Servlets accept a URL parameter and return contents of the</span>
00019 <span class="comment">//      specified type</span>
<a name="l00020"></a><a class="code" href="show__results_8php.html#a2">00020</a> <a class="code" href="show__results_8php.html#a2">$pdb2vrml1</a>=<span class="stringliteral">"/cgi-src/pdb_servlets/pdb2vrml1.php"</span>;
<a name="l00021"></a><a class="code" href="show__results_8php.html#a3">00021</a> <a class="code" href="show__results_8php.html#a3">$pdb2vrml2</a>=<span class="stringliteral">"/cgi-src/pdb_servlets/pdb2vrml2.php"</span>;
<a name="l00022"></a><a class="code" href="show__results_8php.html#a4">00022</a> <a class="code" href="show__results_8php.html#a4">$pdb2ps</a>=<span class="stringliteral">"/cgi-src/pdb_servlets/pdb2ps.php"</span>;
<a name="l00023"></a><a class="code" href="show__results_8php.html#a5">00023</a> <a class="code" href="show__results_8php.html#a5">$pdb2png</a>=<span class="stringliteral">"/cgi-src/pdb_servlets/pdb2png.php"</span>;
00024 
<a name="l00025"></a><a class="code" href="show__results_8php.html#a6">00025</a> <a class="code" href="show__results_8php.html#a6">$file_path</a>=$_SERVER['SCRIPT_NAME'];
<a name="l00026"></a><a class="code" href="show__results_8php.html#a7">00026</a> <a class="code" href="show__results_8php.html#a7">$path</a>= dirname ($file_path);
00027 
00028 echo <span class="stringliteral">"&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;WebGramm results&lt;/TITLE&gt;"</span>;
00029 
<a name="l00030"></a><a class="code" href="show__results_8php.html#a8">00030</a> <a class="code" href="show__results_8php.html#a8">$job</a>=basename( dirname(__FILE__) );
00031 
<a name="l00032"></a><a class="code" href="show__results_8php.html#a9">00032</a> <a class="code" href="show__results_8php.html#a9">$file</a>=<span class="stringliteral">"./rpar.gr"</span>;
<a name="l00033"></a><a class="code" href="show__results_8php.html#a10">00033</a> <a class="code" href="show__results_8php.html#a10">$date</a>=date( <span class="stringliteral">"j F Y H:i"</span>, filemtime(<span class="stringliteral">"$file"</span>) );
00034 <span class="comment"></span>
00035 <span class="comment">/// The results of file_exists function are cached.</span>
00036 <span class="comment"></span>clearstatcache();
00037         <span class="comment"></span>
00038 <span class="comment">/// variables to control gramm parameters</span>
<a name="l00039"></a><a class="code" href="show__results_8php.html#a11">00039</a> <span class="comment"></span><a class="code" href="show__results_8php.html#a11">$from</a>=$_GET[<span class="stringliteral">"from"</span>];
<a name="l00040"></a><a class="code" href="show__results_8php.html#a12">00040</a> <a class="code" href="show__results_8php.html#a12">$to</a>=$_GET[<span class="stringliteral">"to"</span>];
00041 
00042 <span class="keywordflow">if</span> (isset($from) &amp;&amp; isset($to))
00043         <span class="keywordflow">if</span> ( (<a class="code" href="show__results_8php.html#a11">$from</a> != <span class="stringliteral">""</span>) &amp;&amp; ($from &lt; $to) &amp;&amp; ($from &gt;0) &amp;&amp; (<a class="code" href="show__results_8php.html#a11">$from</a> &lt; 999) &amp;&amp; (<a class="code" href="show__results_8php.html#a12">$to</a> != <span class="stringliteral">""</span>)  &amp;&amp; (<a class="code" href="show__results_8php.html#a12">$to</a> &gt; 1)  &amp;&amp; (<a class="code" href="show__results_8php.html#a12">$to</a> &lt;= 1000) )
00044             <span class="comment">// With correct 'from' and 'to' values we run gramm</span>
00045             <span class="keywordflow">if</span> ( ! file_exists(<span class="stringliteral">"./started"</span>))
00046                 <a class="code" href="show__results_8php.html#a18">run_gramm_coord</a>($from, $to);
00047 
00048 
00049 <span class="keywordflow">if</span> ( file_exists(<span class="stringliteral">"./done"</span>) )
00050 {
00051         unlink(<span class="stringliteral">"./started"</span>);
00052         echo <span class="stringliteral">"&lt;META http-equiv=\"Expires\" content=\""</span> . date(<span class="stringliteral">"D, j M Y H:m:s T"</span>) . <span class="stringliteral">"\"&gt;"</span>;
00053         echo <span class="stringliteral">"&lt;/HEAD&gt;&lt;BODY BGCOLOR=\"white\" BACKGROUND=\"./6h2o-w-small.gif\"&gt;"</span>;
00054         
<a name="l00055"></a><a class="code" href="show__results_8php.html#a13">00055</a>         <a class="code" href="show__results_8php.html#a13">$current_dir</a> = <span class="stringliteral">"."</span>;
<a name="l00056"></a><a class="code" href="show__results_8php.html#a14">00056</a>         <a class="code" href="show__results_8php.html#a14">$dir</a> = dir($current_dir);
00057         
00058         echo <span class="stringliteral">"&lt;center&gt;&lt;h1&gt;WebGramm. Gramm results:&lt;br&gt;&lt;/h1&gt;&lt;center&gt;&lt;hr&gt;"</span>;
00059         echo <span class="stringliteral">"&lt;center&gt;&lt;table border=\"2\" bgcolor=\"lightblue\"&gt;"</span>;
00060         
00061         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00062         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00063         {
00064                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00065                 {
00066                         <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a9">$file</a>==<span class="stringliteral">"receptor.pdb"</span> )
00067                         {
00068                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00069                                 echo <span class="stringliteral">"&lt;td&gt;Structure of your receptor molecule.&lt;/td&gt;"</span>; 
00070                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=./$file&gt;$file&lt;/a&gt;&lt;/td&gt;"</span>;
00071                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2vrml1?url=$server$path/$file\"&gt;VRML1&lt;/a&gt; (&lt;a href=\"$pdb2vrml1?reference\"&gt;ref&lt;/A&gt;))&lt;/td&gt;"</span>;
00072                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2vrml2?url=$server$path/$file\"&gt;VRML2&lt;/a&gt;&lt;/td&gt;"</span>;
00073                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2ps?url=$server$path/$file\"&gt;PS&lt;/a&gt;&lt;/td&gt;"</span>;
00074                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00075                         }
00076                 }
00077         }
00078         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00079         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00080         {
00081                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00082                 {
00083                         <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a9">$file</a>==<span class="stringliteral">"ligand.pdb"</span> )
00084                         {
00085                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00086                                 echo <span class="stringliteral">"&lt;td&gt;Structure of your ligand molecule.&lt;/td&gt;"</span>; 
00087                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=./$file&gt;$file&lt;/a&gt;&lt;/td&gt;"</span>;
00088                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2vrml1?url=$server$path/$file\"&gt;VRML1&lt;/a&gt;&lt;/td&gt;"</span>;
00089                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2vrml2?url=$server$path/$file\"&gt;VRML2&lt;/a&gt;&lt;/td&gt;"</span>;
00090                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2ps?url=$server$path/$file\"&gt;PS&lt;/a&gt;&lt;/td&gt;"</span>;
00091                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00092                         }
00093                 }
00094         }
00095         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00096         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00097         {
00098                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00099                 {
00100                         <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a9">$file</a>==<span class="stringliteral">"rpar.gr"</span> )
00101                         {
00102                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00103                                 echo <span class="stringliteral">"&lt;td&gt;Parameters used for the docking procedure&lt;/td&gt;"</span>; 
00104                                 echo <span class="stringliteral">"&lt;td colspan=\"4\"&gt;&lt;a href=./$file&gt;$file&lt;/a&gt;&lt;/td&gt;"</span>;
00105                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00106                         }
00107                 }
00108         }
00109         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00110         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00111         {
00112                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00113                 {
00114                         <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a9">$file</a>==<span class="stringliteral">"rmol.gr"</span> )
00115                         {
00116                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00117                                 echo <span class="stringliteral">"&lt;td&gt;Description of the molecules.&lt;/td&gt;"</span>; 
00118                                 echo <span class="stringliteral">"&lt;td colspan=\"4\"&gt;&lt;a href=./$file&gt;$file&lt;/a&gt;&lt;/td&gt;"</span>;
00119                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00120                         }
00121                 }
00122         }
00123         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00124         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00125         {
00126                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00127                 {
00128                         <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a9">$file</a>==<span class="stringliteral">"gramm.log"</span> )
00129                         {
00130                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00131                                 echo <span class="stringliteral">"&lt;td&gt;Log output produced by GRAMM&lt;/td&gt;"</span>; 
00132                                 echo <span class="stringliteral">"&lt;td colspan=\"4\"&gt;&lt;a href=./$file&gt;$file&lt;/a&gt;&lt;/td&gt;"</span>;
00133                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00134                         }
00135                 }
00136         }
00137         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00138         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00139         {
00140                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00141                 {
00142                         <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a9">$file</a>==<span class="stringliteral">"wlist.gr"</span> )
00143                         {
00144                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00145                                 echo <span class="stringliteral">"&lt;td&gt;Config file to set the results&lt;/td&gt;"</span>; 
00146                                 echo <span class="stringliteral">"&lt;td colspan=\"4\"&gt;&lt;a href=./$file&gt;$file&lt;/a&gt;&lt;/td&gt;"</span>;
00147                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00148                         }
00149                 }
00150         }
00151         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00152         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00153         {
00154                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00155                 {
00156                         <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a9">$file</a>==<span class="stringliteral">"receptor-ligand.res"</span> )
00157                         {
00158                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00159                                 echo <span class="stringliteral">"&lt;td&gt;Listing of the 1000 best scoring docks&lt;/td&gt;"</span>; 
00160                                 echo <span class="stringliteral">"&lt;td colspan=\"4\"&gt;&lt;a href=./$file&gt;$file&lt;/a&gt;&lt;/td&gt;"</span>;
00161                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00162                         }
00163                 }
00164         }
00165         
00166         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;rewind();
00167         <span class="keywordflow">while</span> (<a class="code" href="show__results_8php.html#a9">$file</a> = <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;read())
00168         {
00169                 <span class="keywordflow">if</span> (<a class="code" href="show__results_8php.html#a9">$file</a> !=<span class="stringliteral">"."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">".."</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"index.php"</span> &amp;&amp; <a class="code" href="show__results_8php.html#a9">$file</a>!=<span class="stringliteral">"done"</span>)
00170                 {
00171                         <span class="keywordflow">if</span> ( ereg(<span class="stringliteral">"^receptor-ligand_[0-9]+.pdb$"</span>, $file))
00172                         {
00173                                 $filename = basename($file, <span class="stringliteral">".pdb"</span>);
00174                                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00175                                 echo <span class="stringliteral">"&lt;td&gt;Structure of the receptor-ligand complex&lt;/td&gt;"</span>; 
00176                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$filename.pdb\"&gt;$filename&lt;/a&gt;&lt;/td&gt;"</span>;
00177                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2vrml1?url=$server$path/$file\"&gt;VRML1&lt;/a&gt;&lt;/td&gt;"</span>;
00178                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2vrml2?url=$server$path/$file\"&gt;VRML2&lt;/a&gt;&lt;/td&gt;"</span>;
00179                                 echo <span class="stringliteral">"&lt;td&gt;&lt;a href=\"$pdb2ps?url=$server$path/$file\"&gt;PS&lt;/a&gt;&lt;/td&gt;"</span>;
00180                                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00181                         }
00182                 }
00183         }
00184         
00185         echo <span class="stringliteral">"&lt;/table&gt;&lt;/center&gt;"</span>;
00186         echo <span class="stringliteral">"&lt;hr&gt;&lt;br&gt;"</span>;
00187         <a class="code" href="show__results_8php.html#a14">$dir</a>-&gt;close();
00188         
00189         <span class="keywordflow">if</span> ( !isset($from) &amp;&amp; !isset($to) )
00190         {
00191                 echo <span class="stringliteral">"&lt;table border=2&gt;&lt;tr&gt;"</span>;
00192                 echo <span class="stringliteral">"&lt;td valign=\"center\"&gt;&lt;p&gt;&lt;a href=\"$server$path/index.php?from=11&amp;to=20\"&gt;&lt;img SRC=\"./right.gif\" ALT=\"[NEXT]\"&gt;&lt;/a&gt;&lt;td valign=\"center\"&gt; next ten receptor-ligand complexes.&lt;/td&gt; "</span>;
00193                 echo <span class="stringliteral">"&lt;/tr&gt;&lt;/table&gt;"</span>;
00194         }<span class="keywordflow">else</span>
00195         {   
00196             <span class="comment">//Validating values</span>
00197             <span class="keywordflow">if</span> ( (<a class="code" href="show__results_8php.html#a11">$from</a> == <span class="stringliteral">""</span>) || (<a class="code" href="show__results_8php.html#a11">$from</a> &gt; <a class="code" href="show__results_8php.html#a12">$to</a>) || ($from &lt;0) || ($from &gt; 991)|| (<a class="code" href="show__results_8php.html#a12">$to</a> == <span class="stringliteral">""</span>)  ||($to &lt;0)  || ($to &gt; 1000) )
00198             {
00199                 echo <span class="stringliteral">"&lt;CENTER&gt;&lt;H1&gt;ERROR: invalid first and/or last match numbers!&lt;/H1&gt;&lt;/CENTER&gt;"</span>;
00200                 <a class="code" href="processor_8php.html#a10">exit</a>;
00201             }
00202             
00203             <span class="keywordflow">if</span> ( <a class="code" href="show__results_8php.html#a11">$from</a>==<span class="stringliteral">"1"</span> )
00204             {
00205                 echo <span class="stringliteral">"&lt;table border=2&gt;&lt;tr&gt;"</span>;
00206                 echo <span class="stringliteral">"&lt;td valign=\"center\"&gt;&lt;p&gt;&lt;a href=\"$server$path/index.php?from=11&amp;to=20\"&gt;&lt;img SRC=\"./right.gif\" ALT=\"[NEXT]\"&gt;&lt;/a&gt;&lt;td valign=\"center\"&gt; next ten receptor-ligand complexes.&lt;/td&gt;"</span>;
00207                 echo <span class="stringliteral">"&lt;/tr&gt;&lt;/table&gt;"</span>;
00208             }elseif ($to==<span class="stringliteral">"1000"</span> )
00209             {   
00210                 echo <span class="stringliteral">"&lt;table border=2&gt;&lt;tr&gt;"</span>;
00211                 echo <span class="stringliteral">"&lt;td valign=\"center\"&gt;&lt;p&gt;&lt;a href=\"$server$path/index.php?from=991&amp;to=1000\"&gt;&lt;img SRC=\"./left.gif\" ALT=\"[PREVIOUS]\"&gt;&lt;/a&gt;&lt;td valign=\"center\"&gt; previous ten receptor-ligand complexes.&lt;/td&gt;"</span>;
00212                 echo <span class="stringliteral">"&lt;/tr&gt;&lt;/table&gt;"</span>;
00213             }<span class="keywordflow">else</span>
00214             {   <span class="comment">// trick for the gramm parameters</span>
00215                 $from_next=<a class="code" href="show__results_8php.html#a11">$from</a> + 10;
00216                 $to_next=<a class="code" href="show__results_8php.html#a12">$to</a> + 10;
00217                 $from_prev=<a class="code" href="show__results_8php.html#a11">$from</a> - 10;
00218                 $to_prev=<a class="code" href="show__results_8php.html#a12">$to</a> - 10;
00219                 
00220                 echo <span class="stringliteral">"&lt;table border=2&gt;"</span>;
00221                 echo <span class="stringliteral">"&lt;tr&gt;&lt;td colspan=2 width=100%&gt;Receptor-ligand complexes&lt;/td&gt;&lt;/tr&gt;"</span>;
00222                 echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00223                 echo <span class="stringliteral">"&lt;td width=50% valign=\"center\"&gt;&lt;p&gt;&lt;a href=\"$server$path/index.php?from=$from_prev&amp;to=$to_prev\"&gt;&lt;center&gt;&lt;img SRC=\"./left.gif\" ALT=\"[PREVIOUS]\"&gt;&lt;/center&gt;&lt;/a&gt;&lt;/td&gt;"</span>;
00224                 echo <span class="stringliteral">"&lt;td width=50% valign=\"center\"&gt;&lt;p&gt;&lt;a href=\"$server$path/index.php?from=$from_next&amp;to=$to_next\"&gt;&lt;center&gt;&lt;img SRC=\"./right.gif\" ALT=\"[NEXT]\"&gt;&lt;/center&gt;&lt;/a&gt;&lt;/td&gt;"</span>;
00225                 echo <span class="stringliteral">"&lt;/tr&gt;"</span>;
00226                 echo <span class="stringliteral">"&lt;/table&gt;"</span>;
00227                 echo <span class="stringliteral">"&lt;BR&gt;&lt;P&gt;Note: you may need to reload this page if does not display correctly&lt;/P&gt;"</span>;
00228             }
00229         }
00230         
00231         
00232 
00233 } <span class="keywordflow">else</span>
00234 {       
00235         <span class="keywordflow">if</span> ( !isset($from) &amp;&amp; !isset($to) || (<a class="code" href="show__results_8php.html#a11">$from</a>==<span class="stringliteral">""</span> &amp;&amp; <a class="code" href="show__results_8php.html#a12">$to</a>==<span class="stringliteral">""</span>))
00236         {
00237             echo <span class="stringliteral">"&lt;META HTTP-EQUIV=\"Refresh\" CONTENT=\"20; URL=/tmp/$job/index.php\"&gt;"</span>;
00238         }<span class="keywordflow">else</span>
00239         {
00240             echo <span class="stringliteral">"&lt;META HTTP-EQUIV=\"Refresh\" CONTENT=\"20; URL=/tmp/$job/index.php?from=$from&amp;to=$to\"&gt;"</span>;
00241         }
00242         echo <span class="stringliteral">"&lt;/HEAD&gt;&lt;BODY BGCOLOR=\"white\"&gt;"</span>;
00243         echo <span class="stringliteral">"&lt;script language= \"JavaScript1.2\"&gt;"</span>;
00244         echo <span class="stringliteral">"&lt;!--"</span>;
00245         echo <span class="stringliteral">"var bookmarkurl=\"/tmp/$job\""</span>;
00246         echo <span class="stringliteral">"var bookmarktitle=\"$job Results\""</span>;
00247         echo <span class="stringliteral">"function bookmark()"</span>;
00248         echo <span class="stringliteral">"{"</span>;
00249         echo <span class="stringliteral">"   window.external.AddFavorite(bookmarkurl,bookmarktitle)"</span>;
00250         echo <span class="stringliteral">"}"</span>;
00251         echo <span class="stringliteral">"//--&gt;"</span>;
00252         echo <span class="stringliteral">"&lt;/script&gt;"</span>;
00253 
00254 
00255         echo <span class="stringliteral">"&lt;CENTER&gt;&lt;p&gt;&lt;H2&gt;WebGramm. Gramm results.&lt;/H2&gt;&lt;p&gt;&lt;br&gt;&lt;br&gt;"</span>;
00256 
00257         echo <span class="stringliteral">"&lt;TABLE BORDER=\"0\"&gt;&lt;TR&gt;&lt;TD&gt;&lt;IMG SRC=\"Rodin_Penseur.jpg\"&gt;&lt;/TD&gt;&lt;TD ALIGN=\"center\"&gt;"</span>;
00258 
00259         <span class="keywordflow">if</span> ( !isset($from) &amp;&amp; !isset($to) || (<a class="code" href="show__results_8php.html#a11">$from</a>==<span class="stringliteral">""</span> &amp;&amp; <a class="code" href="show__results_8php.html#a12">$to</a>==<span class="stringliteral">""</span>))
00260         {
00261             echo <span class="stringliteral">"&lt;H3&gt;&lt;A HREF=\"/tmp/$job/index.php\" style=\"color:blue; text-decoration:none\"&gt;Reload&lt;/A&gt; this page to update your job status&lt;/H3&gt;"</span>;
00262         } <span class="keywordflow">else</span> {
00263             echo <span class="stringliteral">"&lt;H3&gt;&lt;A HREF=\"/tmp/$job/index.php?from=$from&amp;to=$to\" style=\"color:blue; text-decoration:none\"&gt;Reload&lt;/A&gt; this page to update your job status&lt;/H3&gt;"</span>;
00264         }
00265         echo <span class="stringliteral">"&lt;H3&gt;or&lt;/H3&gt;"</span>;
<a name="l00266"></a><a class="code" href="show__results_8php.html#a15">00266</a>         echo <span class="stringliteral">"&lt;H3&gt;&lt;a href=\"javascript:bookmark();\" style=\"color:blue; text-decoration:none\"&gt;Bookmark&lt;/A&gt; this page to access it later&lt;/H3&gt;"</span>;
00267         echo <span class="stringliteral">"&lt;TABLE border=2 align=center&gt;"</span>;
00268         echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00269         echo <span class="stringliteral">"&lt;td VALIGN=\"top\" ALIGN=\"center\" COLSPAN=\"6\"&gt;&lt;b&gt;Your Gramm Job is running.&lt;/b&gt;&lt;/td&gt;"</span>;
00270         echo <span class="stringliteral">"&lt;/tr&gt;"</span>;
00271         echo <span class="stringliteral">"&lt;tr&gt;"</span>;
00272 
00273         echo <span class="stringliteral">"&lt;td BGCOLOR=\"#cccccc\" VALIGN=\"top\" ALIGN=\"center\"&gt;&lt;b&gt;Gramm Job number: &lt;/b&gt;&lt;/td&gt;"</span>;
00274         echo <span class="stringliteral">"&lt;td BGCOLOR=\"LightBlue\" VALIGN=\"top\" ALIGN=\"center\"&gt;&lt;b&gt; $job &lt;/b&gt;&lt;/td&gt;"</span>;
00275         
00276         echo <span class="stringliteral">"&lt;td BGCOLOR=\"#cccccc\" VALIGN=\"top\" ALIGN=\"center\"&gt;&lt;b&gt;Status: &lt;/b&gt;&lt;/td&gt;"</span>;
<a name="l00277"></a><a class="code" href="show__results_8php.html#a16">00277</a>         <a class="code" href="show__results_8php.html#a16">$status</a>=<span class="stringliteral">"Running"</span>; <a class="code" href="show__results_8php.html#a17">$color</a>=<span class="stringliteral">"LightGreen"</span>;
00278         echo <span class="stringliteral">"&lt;td BGCOLOR=\"$color\" VALIGN=\"top\" ALIGN=\"center\" BGCOLOR=\"$color\"&gt;&lt;b&gt; $status &lt;/b&gt;&lt;/td&gt;"</span>;
00279 
00280         echo <span class="stringliteral">"&lt;td BGCOLOR=\"#cccccc\" VALIGN=\"top\" ALIGN=\"center\"&gt;&lt;b&gt;Start Date: &lt;/b&gt;&lt;/td&gt;"</span>;
00281         echo <span class="stringliteral">"&lt;td BGCOLOR=\"LightBlue\" VALIGN=\"top\" ALIGN=\"center\"&gt;&lt;b&gt; $date &lt;/b&gt;&lt;/td&gt;"</span>;
00282 
00283         echo <span class="stringliteral">"&lt;/tr&gt;"</span>;   
00284         echo <span class="stringliteral">"&lt;/TABLE&gt;"</span>;
00285 
00286         echo <span class="stringliteral">"&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt;"</span>;
00287 
00288         echo <span class="stringliteral">"&lt;BR&gt;&lt;BR&gt;&lt;CENTER&gt;&lt;STRONG&gt;Note:&lt;/STRONG&gt; This page updates itself automatically every 20 seconds&lt;/CENTER&gt;"</span>;
00289 }
00290 
00291 echo <span class="stringliteral">"&lt;/BODY&gt;&lt;/HTML&gt;"</span>;<span class="comment"></span>
00292 <span class="comment">/////////////////////////////// SUBROUTINES ////////////////////////////////</span>
00293 <span class="comment"></span><span class="comment"></span>
00294 <span class="comment">/**</span>
00295 <span class="comment"> * Re-run GRAMM to generate the coordinates</span>
00296 <span class="comment"> */</span>
<a name="l00297"></a><a class="code" href="show__results_8php.html#a18">00297</a> function <a class="code" href="show__results_8php.html#a18">run_gramm_coord</a>($from , $to)
00298 {   
00299 
00300     $fd = fopen(<span class="stringliteral">"./wlist.gr"</span>, <span class="stringliteral">"w"</span>);
00301 
00302     fwrite( $fd, <span class="stringliteral">"# File_of_predictions   First_match   Last_match   separate/joint  +init_lig\n"</span> );
00303     fwrite( $fd, <span class="stringliteral">"# ----------------------------------------------------------------------------\n"</span> );
00304     fwrite( $fd, <span class="stringliteral">"receptor-ligand.res   $from   $to     separ   no\n"</span> );        
00305 
00306     fclose($fd);
00307     
00308     $started = fopen(<span class="stringliteral">"./started"</span>, <span class="stringliteral">"w"</span>);
00309     fclose($started);   
00310     <span class="comment">//executing gramm</span>
00311     exec(<span class="stringliteral">"rm -f receptor-ligand_*"</span>);
00312     exec(<span class="stringliteral">"rm -f done"</span>);                 
00313     exec(<span class="stringliteral">"./gramm.sh coord"</span>);
00314 }
00315 
00316 ?&gt;
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Mar 28 22:17:13 2005 for WebGRAMM by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
